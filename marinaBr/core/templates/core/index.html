{% load static %}

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="{% static 'assets/img/logo.svg' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'styles/css/main.css' %}">
    <title>Maria Br</title>
</head>
<body>
    <header class="header container">
        <div class="header__logo logo">
            <a href="/">
                <img src="{% static 'assets/img/logo.svg' %}" alt="logo">
            </a>
        </div>
        <div class="header__nav">
            <div class="header__cart">
                <a href="{% url 'cart' %}">
                    <img src="{% static 'assets/icons/cart.svg' %}" alt="cart">
                    {% if cart_total > 0 %}
                        <span class="cart-badge">{{ cart_total }}</span>
                    {% endif %}
                </a>
            </div>
            <nav class="header__menu menu" id="nav-menu">
                <a href="#conditions">Условия заказа</a>
                <a href="#products">Ассортимент</a>
                <a href="#contacts">Контактная информация</a>
                <a href="#form">Заказать обратный звонок</a>
                <a href="{% url 'cart' %}">Корзина</a>
            </nav>
            <div class="header__burger burger" id="burger">
                <span class="burger__up-line"></span>
                <span class="burger__mid-line"></span>
                <span class="burger__bottom-line"></span>
            </div>
        </div>
        <a href="#" class="button-up" id="button-up">
        </a>
    </header>

    {% if messages %}
        <div class="messages-overlay" id="messages-overlay">
            {% for message in messages %}
                <div class="notification notification-{{ message.tags }} show" data-message-id="{{ forloop.counter }}">
                    <button type="button" class="notification__close" aria-label="Закрыть">×</button>
                    <div class="notification__content">{{ message }}</div>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <section class="hero container">
        <div class="hero__title">
            <h1>
                <span>Мария</span>
                <span>Брюханова</span>
            </h1>
        </div>
        <div class="hero__photo">
            <img src="{% static 'assets/img/photos/photo.png' %}" alt="photo">
        </div>
        <div class="hero__about">
            <p>
                Приготовлю быстро и красиво <br>
                на Ваш праздник
            </p>

            <ul class="hero__list-dishes">
                <li>Гастробоксы</li>
                <li>Фуршеты</li>
            </ul>

            <ul class="hero__list-towns">
                <li>Сосновоборск</li>
                <li>Железногорск</li>
            </ul>
        </div>
    </section>

    <section class="conditions container" id="conditions">
        <div>
            <h2>
                Условия заказа
            </h2>
            <ul>
                <li>
                    Заказ считается оформленным после внесения предоплаты в размере 50%
                </li>
                <li>
                    Бесплатная доставка от 3000р по Сосновоборску, от 5000р 
                    в Железногорск, Березовку и Подгорный. 
                    В Красноярск доставка по тарифу Яндекс.Курьер
                </li>
                <li>
                    ‼️Важно ‼️Срок хранения большинства закусок всего 
                    несколько часов, поэтому оформляйте заказ к тому времени, 
                    когда планируете садиться за стол.
                </li>
            </ul>
        </div>
    </section>

    <section class="products container" id="products">
        <h2>Ассортимент</h2>
        <ul class="products__list" id="list-categoties">
            {% for category in categories %}
                <li id="{{ category.id }}" class="category-filter">
                    {{ category.title }}
                </li>
            {% endfor %}
            {% if ready_solutions %}
                <li id="ready_solutions" class="category-filter">
                    Готовые решения
                </li>
            {% endif %}
        </ul>
        <ul class="products__menu-products menu-products" id='list-products'>
            {% if ready_solutions_10 or ready_solutions_15 %}
                <li class="ready-solutions-wrapper" context="ready_solutions" data-type="ready_solutions_group">
                    <div class="ready-solutions-container">
                        {% if ready_solutions_10 %}
                            <div class="ready-solutions-column ready-solutions-10">
                                <h3 class="ready-solutions-column__title">Меню на 10 человек</h3>
                                <div class="ready-solutions-column__items">
                                    {% for solution in ready_solutions_10 %}
                                        <div class="bundle-item" data-ready-solution-id="{{ solution.id }}" data-type="ready_solution">
                                            <div class="bundle-item__title-top">
                                                <h2>{{ solution.title }}</h2>
                                            </div>

                                            {% if solution.get_items %}
                                                <div class="bundle-item__images-grid">
                                                    {% for item in solution.get_items %}
                                                        {% if item.product.imageMain %}
                                                            <div class="bundle-item__image-with-title">
                                                                <div class="bundle-item__image-small">
                                                                    <img src="{{ item.product.imageMain.url }}" alt="{{ item.product.title }}">
                                                                </div>
                                                                <p class="bundle-item__product-name">{{ item.product.title }}{% if item.quantity > 1 %} × {{ item.quantity }}{% endif %}</p>
                                                            </div>
                                                        {% endif %}
                                                    {% endfor %}
                                                </div>
                                            {% endif %}

                                            <div class="bundle-item__price-section">
                                                <p class="bundle-item__price">{{ solution.price }} ₽</p>
                                            </div>

                                            <div class="item__buttons">
                                                <div class="button-config">
                                                    <button type="button" class="decrease-qty">-</button>
                                                    <span class="item-quantity">1</span>
                                                    <button type="button" class="increase-qty">+</button>
                                                </div>
                                                <button class="button-to-card button-ready-solution" type="button" data-ready-solution-id="{{ solution.id }}">
                                                    В корзину
                                                </button>
                                            </div>
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                        {% endif %}

                        {% if ready_solutions_15 %}
                            <div class="ready-solutions-column ready-solutions-15">
                                <h3 class="ready-solutions-column__title">Меню на 15 человек</h3>
                                <div class="ready-solutions-column__items">
                                    {% for solution in ready_solutions_15 %}
                                        <div class="bundle-item" data-ready-solution-id="{{ solution.id }}" data-type="ready_solution">
                                            <div class="bundle-item__title-top">
                                                <h2>{{ solution.title }}</h2>
                                            </div>

                                            {% if solution.get_items %}
                                                <div class="bundle-item__images-grid">
                                                    {% for item in solution.get_items %}
                                                        {% if item.product.imageMain %}
                                                            <div class="bundle-item__image-with-title">
                                                                <div class="bundle-item__image-small">
                                                                    <img src="{{ item.product.imageMain.url }}" alt="{{ item.product.title }}">
                                                                </div>
                                                                <p class="bundle-item__product-name">{{ item.product.title }}{% if item.quantity > 1 %} × {{ item.quantity }}{% endif %}</p>
                                                            </div>
                                                        {% endif %}
                                                    {% endfor %}
                                                </div>
                                            {% endif %}

                                            <div class="bundle-item__price-section">
                                                <p class="bundle-item__price">{{ solution.price }} ₽</p>
                                            </div>

                                            <div class="item__buttons">
                                                <div class="button-config">
                                                    <button type="button" class="decrease-qty">-</button>
                                                    <span class="item-quantity">1</span>
                                                    <button type="button" class="increase-qty">+</button>
                                                </div>
                                                <button class="button-to-card button-ready-solution" type="button" data-ready-solution-id="{{ solution.id }}">
                                                    В корзину
                                                </button>
                                            </div>
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </li>
            {% endif %}

            {% for product in products %}
            <li class="menu-products__item item" context="{{ product.category.id }}" data-product-id="{{ product.id }}">
                {% if product.imageMain %}
                    <div class="item__photo">
                        <img src="{{ product.imageMain.url }}" alt="{{ product.title }}">
                    </div>
                {% endif %}

                <div class="item__title">
                    <h2>
                        {{ product.title }}
                    </h2>
                    <p>{{ product.price }} ₽</p>
                </div>

                <div class="item__description">
                    <p>
                        {{ product.description }}
                    </p>

                    {% if product.ingredients %}
                        <p>
                            {{ product.ingredients }}
                        </p>
                    {% endif %}

                    {% if product.ingredientsList %}
                        <ul>
                            {% for ingredient in product.get_ingredients_list %}
                                <li>{{ ingredient }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                    
                    {% if product.availableFrom %}
                        {% if product.category.id != 4 %}
                            <p>
                                Доступны к заказу от {{ product.availableFrom }} шт.
                            </p>
                        {% endif %}
                    {% endif %}

                    {% if product.priceAdditional %}
                        <p>
                            Цена указана за 1 кг <br>
                            120г - {{ product.priceAdditional }} рублей 

                            {% if product.availableFrom %}
                                (от {{ product.availableFrom }} шт)
                            {% endif %}
                        </p>
                    {% endif %}

                    {% if product.priceFor %}
                        <p>
                            Цена указана за 1 штуку
                        </p>
                    {% endif %}
                </div>

                <div class="item__buttons">
                    <div class="button-config">
                        <button type="button" class="decrease-qty">-</button>
                        <span class="item-quantity">1</span>
                        <button type="button" class="increase-qty">+</button>
                    </div>
                    <button class="button-to-card" type="button" data-product-id="{{ product.id }}">
                        В корзину
                    </button>
                </div>
            </li>
            {% endfor %}
        </ul>
    </section>

    <section class="contacts-info container" id="contacts">
        <div class="contacts-info__title">
            <h2>
                Контактная информация
            </h2>
        </div>
        <div class="contacts-info__info">
            <p>
                Если есть какие-то вопросы, Вы можете позвонить по номеру +7 (953) 596-55-20 
                либо заполнить форму обратной связи ниже.
            </p>
            <p>
                Доступен самовывоз по адресу: Сосновоборск, улица Ленинского Комсомола, 25.
            </p>
        </div>
    </section>

    <div class="map container" style="width: 100%;">
        <script type="text/javascript" charset="utf-8" async src="https://api-maps.yandex.ru/services/constructor/1.0/js/?um=constructor%3A91ccc6f30928f0e859e03e6ee01bfc8f28bf7be254d0933e1355b7b15f0d2923&amp;width=100%25&amp;height=551&amp;lang=ru_RU&amp;scroll=true"></script>
    </div>

    <section class="container main-form" id="form">
        <div class="main-form__title">
            <h2>
                Хотите обсудить нюансы по заказу или любой другой вопрос?
            </h2>
            <p>
                Заполните форму и опишите свой вопрос. Я обязательно Вам перезвоню.
            </p>
        </div>
        <form method="post" action="{% url 'index' %}" class="main-form__form">
            {% csrf_token %}
            <label for="id_name">Имя:</label>
            <input type="text" name="name" id="id_name" placeholder="Имя" value="{{ form.name.value|default:'' }}" required>

            <label for="id_phone">Номер телефона:</label>
            <input type="tel" name="phone" id="id_phone" placeholder="+7 (999) 999 99 99" value="{{ form.phone.value|default:'' }}" required>

            <label for="id_question">Ваш вопрос:</label>
            <textarea name="question" id="id_question" rows="3" placeholder="Опишите ваш вопрос...">{{ form.question.value|default:'' }}</textarea>

            <input type="submit" value="Отправить">
        </form>
    </section>

    <footer class="footer container">
        <div class="footer__messengers">
            <div>
                <a href="http://">
                    <img src="{% static 'assets/icons/vk.svg' %}" alt="VK">
                </a>
            </div>
            <div>
                <a href="http://">
                    <img src="{% static 'assets/icons/whatsapp.svg' %}" alt="whatsapp">
                </a>
            </div>
        </div>
        <address>
            <a href="tel:+79535965520">+7(953)596-55-20</a>
            <a href="https://yandex.ru/maps/-/CLUFzZ~w">
                Сосновоборск, улица Ленинского Комсомола, 25 
            </a>
        </address>
    </footer>

    <script src="{% static 'scripts/burger.js' %}"></script>
    <script src="{% static 'scripts/buttonUp.js' %}"></script>
    <script src="{% static 'scripts/cart.js' %}"></script>
    <script src="{% static 'scripts/category-filter.js' %}"></script>
    <script src="{% static 'scripts/notifications.js' %}"></script>
</body>
</html>